{"class":"org.apache.spark.ml.feature.SQLTransformer","timestamp":1551841545645,"sparkVersion":"2.4.0","uid":"SQLTransformer_24cf28da7626","paramMap":{"statement":"         SELECT label, userId,             MAX(songInterval) AS songInterval,             (MAX(paidCount) / MAX(songCount)) AS paidRatio,             (COUNT(CASE WHEN event_name == \"About\" THEN pageCount END) / SUM(songCount)) AS About,(COUNT(CASE WHEN event_name == \"Add_Friend\" THEN pageCount END) / SUM(songCount)) AS Add_Friend,(COUNT(CASE WHEN event_name == \"Add_to_Playlist\" THEN pageCount END) / SUM(songCount)) AS Add_to_Playlist,(COUNT(CASE WHEN event_name == \"Downgrade\" THEN pageCount END) / SUM(songCount)) AS Downgrade,(COUNT(CASE WHEN event_name == \"Error\" THEN pageCount END) / SUM(songCount)) AS Error,(COUNT(CASE WHEN event_name == \"Help\" THEN pageCount END) / SUM(songCount)) AS Help,(COUNT(CASE WHEN event_name == \"Home\" THEN pageCount END) / SUM(songCount)) AS Home,(COUNT(CASE WHEN event_name == \"Logout\" THEN pageCount END) / SUM(songCount)) AS Logout,(COUNT(CASE WHEN event_name == \"NextSong\" THEN pageCount END) / SUM(songCount)) AS NextSong,(COUNT(CASE WHEN event_name == \"Roll_Advert\" THEN pageCount END) / SUM(songCount)) AS Roll_Advert,(COUNT(CASE WHEN event_name == \"Save_Settings\" THEN pageCount END) / SUM(songCount)) AS Save_Settings,(COUNT(CASE WHEN event_name == \"Settings\" THEN pageCount END) / SUM(songCount)) AS Settings,(COUNT(CASE WHEN event_name == \"Submit_Downgrade\" THEN pageCount END) / SUM(songCount)) AS Submit_Downgrade,(COUNT(CASE WHEN event_name == \"Submit_Upgrade\" THEN pageCount END) / SUM(songCount)) AS Submit_Upgrade,(COUNT(CASE WHEN event_name == \"Thumbs_Down\" THEN pageCount END) / SUM(songCount)) AS Thumbs_Down,(COUNT(CASE WHEN event_name == \"Thumbs_Up\" THEN pageCount END) / SUM(songCount)) AS Thumbs_Up,(COUNT(CASE WHEN event_name == \"Upgrade\" THEN pageCount END) / SUM(songCount)) AS Upgrade         FROM __THIS__         GROUP BY label, userId"},"defaultParamMap":{}}
